# RHS333 (unofficial)  

## Iptables (Lab 2.1)   
### Create a new custom chain  
```bash
# iptables -N <chain_name>  
```  
  
### Make sure all incoming traffic is processed by <chain_name> before it is processed by RH-Firewall-1-INPUT  
```bash
# iptables -I INPUT 1 -j <chain_name>  
```  
  
### Save your work  
```bash
# service iptables save
```  
  
### Current observations  
RH-Firewall-1-INPUT is 'lost', _no clue_ where the fuck it goes, but it disappears from ```iptables -L -v -n``` and ```/etc/sysconfig/iptables```.  
  

## TCP Wrappers (Lab 2.2)  
### Make sure that telnet-server and xinetd are installed _and_ enabled  
(The package ```telnet-server``` should pull both ```telnet-server``` and ```xinetd```)  
```bash
# yum install telnet-server
# chkconfig xinetd on
# chkconfig telnet on
```  

### Open up port ```23/tcp``` so that anyone on the network can connect to it  
```bash
# iptables -A RHS333 -p tcp --dport 23 -j ACCEPT
```  
Verify that the setting is correct via ```iptables -Lnv```.  

### Create the ```/var/mesg/``` directory and the executable file ```/var/mesg/deny```  
```bash
# mkdir -p /var/mesg
# touch /var/mesg/deny
```  

Edit the ```/var/mesg/deny``` as follows:  
```bash
#!/bin/bash
echo "External connection refused at $(/bin/date)"
```  

### Modify the ```/etc/hosts.deny``` file so that the ```/var/mesg/deny``` script is run instead of ```in.telnetd``` for all telnet connections from outside the local network  
```bash
# echo "in.telnetd:ALL:/var/mesg/deny" >> /etc/hosts.deny
```  

### Modify the ```/etc/hosts.allow``` file to allow telnet connections from the example.com network (192.168.0/24) and the localhost network (127/8)  
```bash
# echo "in.telnetd:192.168.0. 127." >> /etc/hosts.allow
```  

### Current observations  
None so far  


